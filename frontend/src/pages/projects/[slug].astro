---
import ProjectTemplate from '@/components/templates/ProjectTemplate.astro'
import { getAllProjects } from '@/data/sanity'

export async function getStaticPaths() {
  const projects = await getAllProjects()
  const list = projects ?? []
  return list.map((project, index) => {
    const nextIndex = (index + 1) % list.length
    const next = list[nextIndex]
    return {
      params: { slug: project.slug?.current },
      props: {
        nextProject: {
          titre: next?.titre,
          slug: next?.slug,
          localisation: next?.localisation,
          anneeDebut: next?.anneeDebut,
          anneeFin: next?.anneeFin,
        },
      },
    }
  })
}

const { slug } = Astro.params
const { nextProject } = Astro.props
---

<ProjectTemplate currentSlug={slug!} isPreview={false} nextProject={nextProject} />
