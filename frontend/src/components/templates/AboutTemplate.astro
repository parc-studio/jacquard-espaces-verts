---
/**
 * About Template
 *
 * Self-fetching template for the about page.
 * Fetches its own data based on preview mode.
 */
import BaseLayout from '../../layouts/BaseLayout.astro'
import { getAboutPage } from '../../data/sanity'
import Media from '../media/Media.svelte'
import PortableText from '../portable-text/PortableText.svelte'

interface Props {
  isPreview?: boolean
}

const { isPreview = false } = Astro.props

const aboutPage = await getAboutPage({ preview: isPreview })

const title = aboutPage?.seo?.title || 'Ã€ propos'
const description = aboutPage?.seo?.description || ''
---

<BaseLayout title={title} description={description} isPreview={isPreview} pagePath="/about">
  <main class="about main-grid">
    <section class="about-content">
      {
        aboutPage?.content && (
          <div class="body">
            <PortableText value={aboutPage.content} client:load />
          </div>
        )
      }

      {
        aboutPage?.coverImage && (
          <div class="cover">
            <Media
              media={{ image: aboutPage.coverImage }}
              layout="cover"
              sizes="(max-width: 1023px) 100vw, 33vw"
              client:load
            />
          </div>
        )
      }
    </section>
  </main>

  <style>
    .about {
      padding-block: var(--size-24) var(--size-64);
    }

    .about-content {
      grid-column: 1 / -1;
      display: grid;
      gap: var(--size-24);
    }

    .body {
      grid-column: 1 / -1;
    }

    .cover {
      grid-column: 1 / -1;
      aspect-ratio: 4 / 3;
      overflow: hidden;
      max-width: 460px;
    }

    @media (min-width: 1024px) {
      .about-content {
        grid-template-columns: repeat(8, minmax(0, 1fr));
      }

      .body {
        grid-column: 1 / 6;
      }

      .cover {
        grid-column: 6 / -1;
        justify-self: end;
        width: 100%;
      }
    }
  </style>
</BaseLayout>
